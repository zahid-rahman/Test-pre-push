#!/bin/bash

branch="$(git rev-parse --abbrev-ref HEAD)"
remote_branch="origin/$branch"

# Fetch latest updates
git fetch origin $branch >/dev/null 2>&1

LOCAL=$(git rev-parse $branch)
REMOTE=$(git rev-parse $remote_branch)
BASE=$(git merge-base $branch $remote_branch)

if [ $LOCAL = $REMOTE ]; then
    echo "✅ Your branch is up to date with origin/$branch."
    exit 0
elif [ $LOCAL = $BASE ]; then
    echo "❌ Your branch is behind origin/$branch. Please pull/rebase before pushing."
    exit 1
elif [ $REMOTE = $BASE ]; then
    echo "✅ Your branch is ahead of origin/$branch. Safe to push."
    exit 0
else
    echo "⚠️ Your branch and origin/$branch have diverged. Please pull with rebase first."
    exit 1
fi
